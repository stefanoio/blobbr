window.blobbr=window.blobbr||function(){"use strict";var r={},t={},e=function(){this.originalURL in t&&URL.revokeObjectURL(t[this.originalURL]),delete r[this.originalURL],delete t[this.originalURL]},n=function(t){var e=new FileReader;e.addEventListener("load",function(){t(this.result)}),e.readAsArrayBuffer(r[this.originalURL])},i=function(r){this.getContentAsArrayBuffer(function(t){r(String.fromCharCode.apply(null,new Uint8Array(t)))})},o=function(r){this.getContentAsArrayBuffer(function(t){r(String.fromCharCode.apply(null,new Uint8Array(t)))})},s=function(){return this.originalURL in t||(t[this.originalURL]=URL.createObjectURL(r[this.originalURL])),t[this.originalURL]},l=function(t){if(t in r){var l={originalURL:t,delete:e,type:r[t].type,size:r[t].size,getContentAsArrayBuffer:n,getContentAsUTF8:i,getContentAsUTF16:o};return Object.defineProperty(l,"asURI",{get:s}),l}return!1},b=function(){var t,e={};for(t in r)r.hasOwnProperty(t)&&(e[t]=l(t));return e},a=function(){r[this.blobbr_url]=this.response,"function"==typeof this.blobbr_progress_callback&&this.blobbr_progress_callback(this.response.size,this.response.size,this.blobbr_url),"function"==typeof this.blobbr_done_callback&&this.blobbr_done_callback.call(l(this.blobbr_url),this.status)},c=function(){"function"==typeof this.blobbr_done_callback&&this.blobbr_done_callback.call(this,this.status)},u=function(r){"function"==typeof this.blobbr_progress_callback&&this.blobbr_progress_callback(r.loaded,r.totalSize,this.blobbr_url)},f=function(t,n,i){var o=new XMLHttpRequest;t in r&&e.call({originalURL:t}),o.blobbr_url=t,o.blobbr_done_callback=n,o.blobbr_progress_callback=i,o.addEventListener("load",a),o.addEventListener("abort",c),o.addEventListener("error",c),o.addEventListener("progress",u),o.open("GET",t),o.responseType="blob",o.send()},d=function(){if("URL"in window){var r={load:f,get:l};return Object.defineProperty(r,"blobs",{get:b}),r}return console.error("blobbr: unsupported browser"),!1};return d()}();